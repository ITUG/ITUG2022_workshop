<!DOCTYPE html>
<html>
<head>
    <title>TUSCRIPT workshop </title>

    <!-- meta information -->
    <!-- Diese Vorlage verwendet die impress-js-boilerplate der Digitalen Akademie, Mainz: 
    https://github.com/digicademy/impress-js-boilerplate
    -->
    <meta name="author" content="Torsten Schrade" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <!-- favicons -->
    <link rel="shortcut icon" href="resources/img/favicon.png" />
    <link rel="apple-touch-icon" href="resources/img/apple-touch-icon.png" />

    <!-- CSS reset and grid -->
    <link href="vendor/normalize/normalize-4.1.1.css" rel="stylesheet" />
    <link href="vendor/skeleton/skeleton-2.0.4.css" rel="stylesheet" />

    <!-- fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,600,600italic,400italic,700italic,800,800italic&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css" />

    <!-- styles for included libraries -->

    <!-- chartist -->
    <link rel="stylesheet" href="vendor/chartist/chartist.min-0.9.7.css" />

    <!-- codemirror -->
    <link rel="stylesheet" href="vendor/codemirror/lib/codemirror.css" />

    <!-- highlight -->
    <link rel="stylesheet" href="vendor/highlight/styles/default.css" />
    <link rel="stylesheet" href="resources/css/hljs.linenumbering.css" />

    <!-- magnific popup -->
    <link rel="stylesheet" href="vendor/magnific-popup/magnific-popup-1.1.0.css" />

    <!-- standard presentation styles -->
    <link href="resources/css/style.css" rel="stylesheet" />

    <!-- custom presentation styles -->
    <link href="resources/css/custom.css" rel="stylesheet" />

    <!-- js needed in head -->

    <!-- greuler -->
    <script src="vendor/d3/d3-3.5.6.js"></script>
    <script src="vendor/cola/cola.v3.min.js"></script>
    <script src="vendor/greuler/greuler-0.5.5.min.js"></script>

    <!-- html5 dataset shim for IE -->
    <script src="vendor/impress/html5-dataset.js" type="text/javascript"></script>
</head>

<body>

    <div class="fallback-message">
        <p>
            Your browser <strong>doesn't support the features required</strong> by impress.mod.js,
            so you are presented with a simplified version of this presentation.
        </p>
        <p>
            For the best experience please use the latest <strong>Chrome</strong>, <strong>Safari</strong>
            or <strong>Firefox</strong> browser.
        </p>
    </div>

    <div id="impress">

        <div class="step">
            <h4><strong>24. November 2022</strong> | <a href="https://www.itug.de/pages/aktuelles.html#tuscript2022">ADWL Mainz</a></h4>
            <h4><strong>ITUG Mitgliederversammlung</strong></h4>

            <h1 class="down-100">TUSCRIPT</h1>

            <h2 class="up-25">Eine Einführung</h2>

            <h4 class="down-100">
                <strong>Slides:</strong>
                <a href="https://itug.github.io/ITUG2022_workshop" title="View the presentation online">
                    https://itug.github.io/ITUG2022_workshop
                </a>
            </h4>

            <h5>
                <strong><a href="https://orcid.org/0000-0002-4794-037X">Hans-Werner Bartz</a> | <a href="https://orcid.org/0000-0003-1904-1841">Thomas Kollatz</a></strong> |
                <img src="resources/img/Twitter_bird_logo_2012.svg" alt="Twitter" class="twitter-icon" />
                <a href="https://twitter.com/ITUGeV" title="ITUG on Twitter">@ITUGeV</a> |
                <img src="resources/img/Octicons-mark-github.svg" alt="Twitter" class="gh-icon" />
                <a href="https://github.com/ITUG" title="ITUG on GitHub">ITUG</a> |
                <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>
            </h5>
        </div>
        
        
        <div class="step">
            <h2>TUSCRIPT</h2>
            <h3>ausführen</h3>            
            <pre><code class="js">Gib Kommando >#ma,skriptdatei</code></pre> 
            
             
                    <pre><code class="js">Gib Anweisung >x ,#ma,skriptdatei</code></pre>
            <div class="row">
                <div class="five columns">
                    <pre><code class="js">Gib Anweisung >x,  #ma,&lt;editor&gt;</code></pre></div>
           
                <div class="seven columns even-left">
                     <pre class="up-25">
                         <code>y,*=execute
y,execute=clr_cmd_line,"x #ma,&lt;editor&gt;",confirm
</code>
                    </pre>
                </div>
            </div><div class="row">
                
                <div class="five columns">
                    <pre><code class="js">Gib Kommando >$meinSkript</code></pre>
                </div>
                <div class="seven columns">
                    <p class="medium">Skript ist Segment in einer mit <code>#de,segmentdatei</code> definierten Segmentdatei und beginnt mit <code>$$!</code></p>
                </div>
            </div>
        </div>
        <div class="step">
            <h2>TUSCRIPT</h2>
            <h3>Skriptsprache</h3>
            <pre><code class="linenumbers">$$ PRINT "Hello world"
</code></pre></div>
        <div class="step">
            <h2>Mode</h2>
            <h3>TUSCRIPT – DATA – STATEMENT</h3>
            <div class="row">
                <div class="six columns">
                    <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
var="Hello world"
PRINT var
                        
MODE DATA 
$$ var_stern=*
Hello 
world
                        
$$ MODE STATEMENT
TRACE *var_stern
</code></pre>
                </div>
                <div class="six columns">
                    <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
var="Hello world"
PRINT var
                        

var_stern=*
DATA Hello 
DATA world
                        

TRACE *var_stern
</code></pre>
                </div>
            </div>
        </div>

        <div class="step">
            <h2>Arbeiten mit Dateien</h2>
            <h3>CREATE </h3>
            <div class="row">
                <div class="six columns">
                    <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
file="datei.tf"
status=CREATE (file,SEQ-o,-std-)
                        
IF (status!="OK") THEN 
  PRINT status
  STOP
ENDIF 
</code></pre>
                </div>
                    <div class="six columns">
                        <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
file="datei.tf"
ERROR/STOP CREATE (file,SEQ-o,-std-)
</code></pre>
                </div></div></div>
                <div class="step">
                    <h2>Arbeiten mit Dateien</h2>
                        <h3>anmelden | kopieren | abmelden | umbenennen</h3>
                    <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
file="datei.tf"
-- anmelden READ | WRITE 
ERROR/STOP OPEN (file,READ,-std-)

-- anlegen SEQ | FDF | RAN ; -o | -t | -p 
file_dubble="datei_zwei.tf"
ERROR/STOP CREATE (file_dubble,SEQ-o,-std-)

-- kopieren
ERROR/STOP COPY (file,file_dubble)

-- schliessen
ERROR/STOP CLOSE (file)

-- umbenennen 
old_name=VALUE(file_dubble)
new_name="datei_kopie.tf"
ERROR/STOP RENAME (old_name,new_name)
</code></pre>                    
                </div> 
        <div class="step"> <h2>Arbeiten mit Dateien</h2>
            <h3>Variableninhalt in Datei schreiben – Dateien vergleichen</h3>          
            <div class="row">
                <div class="six columns">
                    <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
file="datei.tf"
-- (zum Schreiben) anmelden 
ERROR/STOP OPEN (file,WRITE,-std-) 
                        
MODE DATA 
$$ content=*
Es gibt nichts Gutes, 
ausser man tut es. 
                        
$$ MODE STATEMENT
FILE/ERASE $file = content
                        
file_new="datei_kopie.tf"


content_new=EXCHANGE (content,"|ss|ß|")

FILE/ERASE $file_new = content_new
                        
status=COMPARE (file,file_new)
TRACE *status
</code></pre>
                </div>
                <div class="six columns">
                    <pre><code>
                        
                        
                        
                        
                        








BUILD X_TABLE ss2buckels=*
DATA |ss|ß|
content_new=EXCHANGE(content,ss2buckels)
RELEASE X_TABLE ssbuckels




</code></pre>
                </div>
            </div>        </div>        
        <div class="step"> <h2>Arbeiten mit Dateien</h2>
            <h3>Dateiinhalt in Variable – Variableninhalt vergleichen</h3>          
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}
file_a="datei.tf"
-- (zum Lesen) anmelden 
ERROR/STOP OPEN (file_a,READ,-std-) 

content_a=FILE (file_a)
TRACE *content_a

file_b="datei_kopie.tf"
ERROR/STOP open (file_b,READ,-std-)

content_b=FILE (file_b)
TRACE *content_b

TRACE 
x=FIND_DIFF (content_a,0,0,content_b,0,0,char_a,char_b,position)
</code></pre>        </div>  
        <div class="step"> <h2>Arbeiten mit Dateien</h2>
            <h3>Dateiinhalte auf Variablen lesen</h3>          
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}

-- Belegung der Systemvariable TUSTEP_DSK abfragen                
FETCH dsk = TUSTEP_DSK

-- Pfad zur Datei 
file="datei.tf"
path2file=ADJUST_PATH (dsk,file)
TRACE *path2file

-- Dateiinhalt (ohne anmelden) auf Variable legen
status=READ (path2file,content)
TRACE *content
</code></pre>        </div> 
        <div class="step"> <h2>Arbeiten mit Dateien</h2>
            <h3>WWW-Content auf Variable lesen – REQUEST</h3>          
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}

url="http://www.itug.de"
daten=REQUEST (url)
daten=DECODE (daten,utf8)

ERROR/STOP CREATE ("daten.tf",seq-o,-std-)
path2tf=ADJUST_PATH (dsk,"daten.tf")

-- Variableninhalt (ohne anmelden) in Datei schreiben
ERROR/STOP WRITE (path2tf,daten)
</code></pre>        </div> 
        <div class="step"> <h2>Arbeiten mit Dateien</h2>
            <h3>Variableninhalt in Datei schreiben</h3>          
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{}

-- Variableninhalt von TUSTEP-Datei auf Variable einlesen
tf_file="datei.tf"
FETCH dsk = TUSTEP_DSK
path2tf=ADJUST_PATH (dsk,tf_file)
ERROR/STOP READ (path2tf,daten)
TRACE *daten

-- Variableninhalt in Fremddatei schreiben
txt_file="datei.txt"
ERROR/STOP CREATE (txt_file,FDF-o,-std-)
path2txt=ADJUST_PATH (dsk,txt_file)
ERROR/STOP WRITE (path2txt,daten,UTF8)
</code></pre>        </div>         
 
        <div class="step">
            <h2>organisatorisches </h2>
            <h3>LOOP</h3>
            <pre><code class="linenumbers">$$ MODE TUSCRIPT,{}
LOOP n=1 to 9
PRINT n
ENDLOOP
</code></pre>
            <pre><code class="linenumbers">$$ MODE TUSCRIPT,{}
filebasename="datei_"                
LOOP n
 IF (n>9) EXIT 
 n=CENTER (n,+2,"0")
 file=CONCAT (filebasename,n,".tf")
 ERROR/STOP CREATE (file,SEQ-o,-std-)
ENDLOOP
PRINT n
</code></pre>
        </div>
        <div class="step">
            <h2>organisatorisches </h2>
            <h3>FILE_NAMES</h3>
            <pre><code class="linenumbers">$$ MODE TUSCRIPT,{} 
TRACE                 
files=FILE_NAMES (-,-std-)
sz_files_1=SIZE(files)

FETCH dsk = TUSTEP_DSK
files=FILE_NAMES (-,$dsk)
sz_files_2=SIZE(files)
</code></pre>
            
        </div>    
    
        <div class="step">
            <h2>organisatorisches </h2>
            <h3>LOOP</h3>
            <pre><code class="linenumbers">$$ MODE TUSCRIPT,{}
LOOP n=1 to 9
PRINT n
ENDLOOP
</code></pre>
            <pre><code class="linenumbers">$$ MODE TUSCRIPT,{}
filebasename="datei_"                
LOOP n
 IF (n>9) EXIT 
 n=CENTER (n,+2,"0")
 file=CONCAT (filebasename,n,".tf")
 ERROR/STOP CREATE (file,SEQ-o,-std-)
ENDLOOP
PRINT n
</code></pre>
        </div>
        <div class="step">
            <h2>organisatorisches </h2>
            <h3>SELECT</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk = TUSTEP_DSK
files=FILE_NAMES (-,$dsk)
sz_files_all=SIZE(files)

BUILD S_TABLE tf=*
DATA |*.tf|

tf_files=SELECT (files,tf)
RELEASE S_TABLE tf

sz_files_tf=SIZE(tf_files)

-- Bedingung .ne. | != | .eq. | == | .gt. | &gt; | .lt. | &lt; 
IF (sz_files_all!=sz_files_tf) TRACE *sz_files_all,sz_files_tf

LOOP n,file=tf_files
 n=CENTER (n,+3,"0")
 PRINT/COLOR:9E n," ",file
ENDLOOP
</code></pre>
            
        </div>        
        <div class="step">
            <h2>organisatorisches </h2>
            <h3>FILTER | FILTER_INDEX</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk = TUSTEP_DSK
files=FILE_NAMES (-,$dsk)

BUILD R_TABLE/or tf=*
DATA |*.tf|
DATA |*.tus|*.tstp|

tf_files=FILTER       (files,tf,-)
tf_index=FILTER_INDEX (files,tf,-)
RELEASE R_TABLE tf

sz_files_tf=SIZE(tf_files)

TRACE *sz_files_tf,tf_index

LOOP n,index=tf_index
 n=CENTER (n,+3,"0")
 file=SELECT (files,#index)
 PRINT/COLOR:E9 n," ",file
ENDLOOP
</code></pre>
            
        </div>    
    
        <div class="step">
            <h2>organisatorisches </h2>
            <h3>modified | TIME_INTERVAL</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC 
FETCH dsk = TUSTEP_DSK
files=FILE_NAMES (-,$dsk)

time=time(0)
PRINT time

BUILD R_TABLE tf="|*.tf|"
tf_files=FILTER  (files,tf,-)
RELEASE R_TABLE tf

sz_tf_files=SIZE (tf_files)

n=0
LOOP file=tf_files
 ERROR/STOP OPEN (file,READ,-std-)
 modified=MODIFIED (file)
 interval=TIME_INTERVAL (hours,time,modified)
 IF (interval>1) THEN 
  n=n+1  
  PRINT/COLOR:E9 n," ",file
 ENDIF
ENDLOOP
PRINT/COLOR:0F "Ergebnis: "
PRINT/COLOR:0F n," tf-Dateien von ",sz_tf_files," sind älter als eine Stunde."
</code></pre>
            
        </div> 
        <div class="step">
            <h2>XML </h2>
            <h3>Datei generieren </h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
MODE DATA
$$ xml=*
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;?xml-model href="http://www.tei-c.org/release/xml/tei/custom/schema/relaxng/tei_lite.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?&gt;
&lt;?xml-model href="http://www.tei-c.org/release/xml/tei/custom/schema/relaxng/tei_lite.rng" type="application/xml"
	schematypens="http://purl.oclc.org/dsdl/schematron"?&gt;
&lt;TEI xmlns="http://www.tei-c.org/ns/1.0"&gt;
 &lt;teiHeader&gt;
 &lt;fileDesc&gt;&lt;titleStmt&gt;&lt;title&gt;Test&lt;/title&gt;&lt;/titleStmt&gt;
 &lt;publicationStmt&gt;&lt;p&gt;intern&lt;/p&gt;&lt;/publicationStmt&gt;
 &lt;sourceDesc&gt;
 &lt;p&gt;Übungsdatei für den TUSCRIPT workshop&lt;/p&gt;
 &lt;/sourceDesc&gt;&lt;/fileDesc&gt;
 &lt;/teiHeader&gt;
 &lt;text&gt;&lt;body&gt;
 &lt;div type="letter"&gt;
 &lt;opener&gt;&lt;salute hand="#TK"&gt;Herzlich Willkommen&lt;/salute&gt;&lt;/opener&gt;
 &lt;p&gt;Es freut mich, dass &lt;lb/&gt;&lt;choice&gt;&lt;del&gt;ihr&lt;/del&gt;&lt;corr&gt;Sie&lt;/corr&gt;&lt;/choice&gt; so &lt;lb/&gt;zahlreich erschienen sind.&lt;/p&gt;
 &lt;/div&gt;&lt;/body&gt;&lt;/text&gt;&lt;/TEI&gt;
$$ MODE STATEMENT
ERROR/STOP CREATE ("test.xml",FDF-o,-std-)
FILE/ERASE/UTF8 "test.xml" = xml
</code></pre>
        </div> 
        <div class="step">
            <h2>XML-Zugriff </h2>
            <h3>Elemente und Attribute</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk=TUSTEP_DSK
file="test.xml"
path2file=ADJUST_PATH (dsk,file)
ERROR/STOP READ (path2file,daten,UTF8)
-- TRACE *daten
ACCESS q: READ/VARIABLE/STREAM daten s,a+t+e,typ,stack,stack_num
LOOP
 READ/EXIT q
 IF (a.hn."salute") PRINT/COLOR:0F t
 IF (a.ha."hand") THEN 
  handvalue=GET_ATTRIBUTE (a,"hand")
  PRINT/COLOR:0F handvalue
 ENDIF 
ENDLOOP
ENDACCESS q
</code></pre>
        </div>
        <div class="step">
            <h2>XML-Zugriff </h2>
            <h3>Leere Elemente sammeln</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk=TUSTEP_DSK
file="test.xml"
path2file=ADJUST_PATH (dsk,file)
ERROR/STOP READ (path2file,daten,UTF8)

ACCESS q: READ/VARIABLE/STREAM daten s,a+t+e,typ,stack,stack_num
LOOP
 READ/EXIT q
 IF (typ==4) THEN
   tagname=GET_TAG_NAME (t)
   PRINT tagname
 ENDIF 
ENDLOOP
ENDACCESS q
</code></pre>
        </div>
        <div class="step">
            <h2>XML-Zugriff </h2>
            <h3>Tags in //text sammeln</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk=TUSTEP_DSK
file="test.xml"
path2file=ADJUST_PATH (dsk,file)
ERROR/STOP READ (path2file,daten,UTF8)
tags=*
ACCESS q: READ/VARIABLE/STREAM daten s,a+t+e,typ,stack,stack_num
LOOP
 READ/EXIT q
 IF (stack.ct."|&lt;text&gt;|") THEN
   IF (typ==4) THEN 
    tagname=GET_TAG_NAME (t)
   ELSE 
    tagname=GET_TAG_NAME (a)
   ENDIF 
   IF (tagname!="") tags=APPEND(tags,tagname)
 ENDIF 
ENDLOOP
ENDACCESS q
TRACE *tags
</code></pre>
        </div>
        <div class="step">
            <h2>XML-Zugriff</h2>
            <h3>Tags in //text in DICTIONARY sammeln</h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk=TUSTEP_DSK
file="test.xml"
path2file=ADJUST_PATH (dsk,file)
ERROR/STOP READ (path2file,daten,UTF8)
DICT tags CREATE 
ACCESS q: READ/VARIABLE/STREAM daten s,a+t+e,typ,stack,stack_num
LOOP
 READ/EXIT q
 IF (stack.ct."|&lt;text&gt;|") THEN
   IF (typ==4) THEN 
    tagname=GET_TAG_NAME (t)
   ELSE 
    tagname=GET_TAG_NAME (a)
   ENDIF 
   IF (tagname!="") DICT tags ADD/QUIET/COUNT tagname 
 ENDIF 
ENDLOOP
ENDACCESS q
DICT tags UNLOAD tagnames,num,cnt
DICT tags SIZE anzahl
PRINT anzahl, " tags"
tag_count=JOIN (tagnames," ",cnt)
TRACE *tag_count
</code></pre>
        </div>   
        <div class="step">
            <h2>XML</h2>
            <h3>TAGS_INDENT </h3>
            <pre><code class="linenumbers xml">$$ MODE TUSCRIPT,{},MAC
FETCH dsk=TUSTEP_DSK
file="test.xml"
path2file=ADJUST_PATH (dsk,file)
ERROR/STOP READ (path2file,daten,UTF8)

daten=JOIN(daten,"")

ASK "Sollen lb ignoriert werden? ja/nein":antwort= ""

IF (antwort.ab."nein") THEN
 daten=INDENT_TAGS (daten,-,"    ")
ELSE
 BUILD R_TABLE/TEXT/OR ign ="|*&lt;lb&gt;|"
 daten=INDENT_TAGS (daten,ign,"    ")
ENDIF

LOOP/CLEAR line=daten
 IF (line=="") CYCLE
 daten=APPEND(daten,line)
ENDLOOP
TRACE *daten
</code></pre>
        </div>   
    </div>

    <!-- jquery -->
    <script src="vendor/jquery/jquery-1.11.0.min.js"></script>

    <!-- chartist -->
    <script src="vendor/chartist/chartist.min-0.9.7.js"></script>
    <script src="resources/js/chartist.charts.js"></script>

    <!-- codemirror -->
    <script src="vendor/codemirror/lib/codemirror.js"></script>
    <script src="vendor/codemirror/addon/edit/matchbrackets.js"></script>
    <script src="vendor/codemirror/mode/sparql/sparql.js"></script>
    <script>
        var editor = CodeMirror.fromTextArea(document.getElementById("sparql"), {
            mode: "application/sparql-query",
            matchBrackets: true,
            lineNumbers: true,
            viewportMargin: Infinity
        });
    </script>

    <!-- highlight -->
    <script src="vendor/highlight/highlight.pack-9.3.0.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="resources/js/hljs.linenumbering.js"></script>

    <!-- magnific popup -->
    <script src="vendor/magnific-popup/jquery.magnific-popup.min-1.1.0.js"></script>
    <script src="resources/js/magnific-popup.lightbox.js"></script>

    <!-- impress.mod.js -->
    <script src="vendor/impress/impress.fork.js"></script>
    <script src="vendor/impress/impress-slidenum.js"></script>
    <script>
        var obj = impress();
        obj.init();
        initSlideNo(obj);
    </script>

</body>
</html>
